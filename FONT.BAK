Unit font;
Interface
Uses dos, gr8bit;
Type CharSet     = set of char;
     str3        = string[3];
     DosFontType = array[0..4095] of byte;
     UserKB      = array[0..127] of str3;
Const
TelexEvKey   = ['a','s','f','r','x','j','d','w','e','o'];
VniEvKey     = ['1','2','3','4','5','6'];
DosFont:DosfontType
=(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,126,129,165,129,129,189,153,129,129,126,0,0,0,0,
0,0,126,255,219,255,255,195,231,255,255,126,0,0,0,0,
0,0,0,0,108,238,254,254,254,124,56,16,0,0,0,0,
0,0,0,0,16,56,124,254,254,124,56,16,0,0,0,0,
0,0,0,24,60,60,90,255,255,90,24,60,0,0,0,0,
0,0,0,16,56,124,254,254,238,84,16,56,0,0,0,0,
0,0,0,0,0,0,24,60,60,24,0,0,0,0,0,0,
255,255,255,255,255,255,231,195,195,231,255,255,255,255,255,255,
0,0,0,0,0,60,102,66,66,102,60,0,0,0,0,0,
255,255,255,255,255,195,153,189,189,153,195,255,255,255,255,255,
0,0,30,14,26,50,120,204,204,204,204,120,0,0,0,0,
0,0,60,102,102,102,102,60,24,126,24,24,0,0,0,0,
0,8,12,10,10,10,8,8,8,120,248,112,0,0,0,0,
0,16,24,20,18,26,22,18,114,242,98,14,30,28,0,0,
0,0,0,16,146,124,108,198,108,124,146,16,0,0,0,0,
0,0,128,192,224,248,254,248,224,192,128,0,0,0,0,0,
0,0,2,6,14,62,254,62,14,6,2,0,0,0,0,0,
0,0,16,56,124,214,16,16,214,124,56,16,0,0,0,0,
0,0,102,102,102,102,102,102,102,0,102,102,0,0,0,0,
0,0,127,219,219,219,219,123,27,27,27,27,0,0,0,0,
0,124,198,96,56,108,198,198,108,56,12,198,124,0,0,0,
0,0,0,0,0,0,0,0,254,254,254,254,0,0,0,0,
0,0,16,56,124,214,16,16,214,124,56,16,254,0,0,0,
0,0,16,56,124,214,16,16,16,16,16,16,0,0,0,0,
0,0,16,16,16,16,16,16,214,124,56,16,0,0,0,0,
0,0,0,0,16,24,12,254,12,24,16,0,0,0,0,0,
0,0,0,0,16,48,96,254,96,48,16,0,0,0,0,0,
0,0,0,0,0,0,192,192,192,254,0,0,0,0,0,0,
0,0,0,0,0,36,66,255,66,36,0,0,0,0,0,0,
0,0,0,0,16,56,56,124,124,254,254,0,0,0,0,0,
0,0,0,0,254,254,124,124,56,56,16,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,24,60,60,60,24,24,24,0,24,24,0,0,0,0,
0,102,102,34,34,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,108,108,254,108,108,254,108,108,0,0,0,0,0,
0,16,16,124,214,214,112,56,28,214,214,124,16,16,0,0,
0,0,96,146,150,108,24,48,108,210,146,12,0,0,0,0,
0,0,56,108,108,56,48,118,220,204,204,118,0,0,0,0,
0,24,24,8,16,0,0,0,0,0,0,0,0,0,0,0,
0,0,12,24,48,48,48,48,48,48,24,12,0,0,0,0,
0,0,48,24,12,12,12,12,12,12,24,48,0,0,0,0,
0,0,0,0,0,102,60,255,60,102,0,0,0,0,0,0,
0,0,0,0,0,24,24,126,24,24,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,48,48,16,32,0,0,
0,0,0,0,0,0,0,254,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,
0,0,0,2,6,12,24,48,96,192,128,0,0,0,0,0,
0,0,124,198,198,206,222,246,230,198,198,124,0,0,0,0,
0,0,24,56,120,24,24,24,24,24,24,126,0,0,0,0,
0,0,124,198,6,12,24,48,96,192,198,254,0,0,0,0,
0,0,124,198,6,6,60,6,6,6,198,124,0,0,0,0,
0,0,12,28,60,108,204,204,254,12,12,30,0,0,0,0,
0,0,254,192,192,192,252,6,6,6,198,124,0,0,0,0,
0,0,124,198,192,192,252,198,198,198,198,124,0,0,0,0,
0,0,254,198,6,6,12,24,48,48,48,48,0,0,0,0,
0,0,124,198,198,198,124,198,198,198,198,124,0,0,0,0,
0,0,124,198,198,198,198,126,6,6,198,124,0,0,0,0,
0,0,0,0,24,24,0,0,0,24,24,0,0,0,0,0,
0,0,0,0,24,24,0,0,0,24,24,8,16,0,0,0,
0,0,0,6,12,24,48,96,48,24,12,6,0,0,0,0,
0,0,0,0,0,126,0,0,126,0,0,0,0,0,0,0,
0,0,0,96,48,24,12,6,12,24,48,96,0,0,0,0,
0,0,124,198,198,6,12,24,24,0,24,24,0,0,0,0,
0,0,0,60,66,157,165,165,173,182,64,60,0,0,0,0,
0,0,56,108,198,198,198,254,198,198,198,198,0,0,0,0,
0,0,252,102,102,102,124,102,102,102,102,252,0,0,0,0,
0,0,124,198,198,192,192,192,192,198,198,124,0,0,0,0,
0,0,252,102,102,102,102,102,102,102,102,252,0,0,0,0,
0,0,254,102,98,104,120,120,104,98,102,254,0,0,0,0,
0,0,254,102,98,104,120,120,104,96,96,240,0,0,0,0,
0,0,124,198,198,192,192,206,198,198,198,126,0,0,0,0,
0,0,198,198,198,198,254,198,198,198,198,198,0,0,0,0,
0,0,60,24,24,24,24,24,24,24,24,60,0,0,0,0,
0,0,30,12,12,12,12,12,204,204,204,120,0,0,0,0,
0,0,230,102,102,108,120,120,108,102,102,230,0,0,0,0,
0,0,240,96,96,96,96,96,96,98,102,254,0,0,0,0,
0,0,130,198,238,254,254,214,198,198,198,198,0,0,0,0,
0,0,134,198,230,246,254,222,206,198,198,198,0,0,0,0,
0,0,124,198,198,198,198,198,198,198,198,124,0,0,0,0,
0,0,252,102,102,102,102,124,96,96,96,240,0,0,0,0,
0,0,124,198,198,198,198,198,198,214,222,124,6,0,0,0,
0,0,252,102,102,102,102,124,108,102,102,230,0,0,0,0,
0,0,124,198,198,96,56,12,6,198,198,124,0,0,0,0,
0,0,126,126,90,24,24,24,24,24,24,60,0,0,0,0,
0,0,198,198,198,198,198,198,198,198,198,124,0,0,0,0,
0,0,198,198,198,198,198,198,198,108,56,16,0,0,0,0,
0,0,198,198,198,198,198,214,254,238,198,130,0,0,0,0,
0,0,198,198,108,124,56,56,124,108,198,198,0,0,0,0,
0,0,102,102,102,102,60,24,24,24,24,60,0,0,0,0,
0,0,254,198,134,12,24,48,96,194,198,254,0,0,0,0,
0,0,60,48,48,48,48,48,48,48,48,60,0,0,0,0,
0,0,0,128,192,96,48,24,12,6,2,0,0,0,0,0,
0,0,60,12,12,12,12,12,12,12,12,60,0,0,0,0,
16,56,108,198,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,255,0,0,
0,24,24,16,8,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,120,12,124,204,204,204,118,0,0,0,0,
0,0,224,96,96,124,102,102,102,102,102,124,0,0,0,0,
0,0,0,0,0,124,198,192,192,192,198,124,0,0,0,0,
0,0,28,12,12,124,204,204,204,204,204,118,0,0,0,0,
0,0,0,0,0,124,198,198,254,192,198,124,0,0,0,0,
0,0,28,54,48,120,48,48,48,48,48,120,0,0,0,0,
0,0,0,0,0,118,204,204,204,204,204,124,12,204,120,0,
0,0,224,96,96,108,118,102,102,102,102,230,0,0,0,0,
0,0,24,24,0,56,24,24,24,24,24,60,0,0,0,0,
0,0,12,12,0,28,12,12,12,12,12,12,204,204,120,0,
0,0,224,96,96,102,108,120,120,108,102,230,0,0,0,0,
0,0,56,24,24,24,24,24,24,24,24,60,0,0,0,0,
0,0,0,0,0,236,254,214,214,214,214,198,0,0,0,0,
0,0,0,0,0,220,102,102,102,102,102,102,0,0,0,0,
0,0,0,0,0,124,198,198,198,198,198,124,0,0,0,0,
0,0,0,0,0,220,102,102,102,102,102,124,96,96,240,0,
0,0,0,0,0,124,204,204,204,204,204,124,12,12,30,0,
0,0,0,0,0,222,118,96,96,96,96,240,0,0,0,0,
0,0,0,0,0,124,198,96,56,12,198,124,0,0,0,0,
0,0,16,48,48,252,48,48,48,48,52,24,0,0,0,0,
0,0,0,0,0,204,204,204,204,204,204,118,0,0,0,0,
0,0,0,0,0,198,198,198,198,108,56,16,0,0,0,0,
0,0,0,0,0,198,214,214,214,214,254,108,0,0,0,0,
0,0,0,0,0,198,198,108,56,108,198,198,0,0,0,0,
0,0,0,0,0,198,198,198,198,198,198,126,6,12,248,0,
0,0,0,0,0,254,140,24,48,96,194,254,0,0,0,0,
0,0,14,24,24,24,112,24,24,24,24,14,0,0,0,0,
0,0,24,24,24,24,0,0,24,24,24,24,0,0,0,0,
0,0,112,24,24,24,14,24,24,24,24,112,0,0,0,0,
0,0,118,220,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,16,56,108,198,198,198,254,0,0,0,0,0,
0,0,124,198,198,192,192,192,192,198,198,124,16,8,112,0,
0,0,204,204,0,204,204,204,204,204,204,118,0,0,0,0,
0,6,12,16,0,124,198,198,254,192,198,124,0,0,0,0,
0,48,120,204,0,120,12,124,204,204,204,118,0,0,0,0,
0,0,204,204,0,120,12,124,204,204,204,118,0,0,0,0,
0,192,96,16,0,120,12,124,204,204,204,118,0,0,0,0,
0,48,72,48,0,120,12,124,204,204,204,118,0,0,0,0,
0,0,0,0,0,124,198,192,192,192,198,124,16,8,112,0,
0,24,60,102,0,124,198,198,254,192,198,124,0,0,0,0,
0,0,198,198,0,124,198,198,254,192,198,124,0,0,0,0,
0,192,96,16,0,124,198,198,254,192,198,124,0,0,0,0,
0,0,102,102,0,56,24,24,24,24,24,60,0,0,0,0,
0,24,60,102,0,56,24,24,24,24,24,60,0,0,0,0,
0,192,96,16,0,56,24,24,24,24,24,60,0,0,0,0,
198,198,0,56,108,198,198,254,198,198,198,198,0,0,0,0,
56,68,56,56,108,198,198,254,198,198,198,198,0,0,0,0,
6,12,16,254,102,98,104,120,104,98,102,254,0,0,0,0,
0,0,0,0,0,124,18,114,158,144,146,124,0,0,0,0,
0,0,62,106,200,200,204,252,200,200,202,206,0,0,0,0,
0,24,60,102,0,124,198,198,198,198,198,124,0,0,0,0,
0,0,198,198,0,124,198,198,198,198,198,124,0,0,0,0,
0,192,96,16,0,124,198,198,198,198,198,124,0,0,0,0,
0,48,120,204,0,204,204,204,204,204,204,118,0,0,0,0,
0,192,96,16,0,204,204,204,204,204,204,118,0,0,0,0,
0,0,198,198,0,198,198,198,198,198,198,126,6,12,120,0,
198,198,0,124,198,198,198,198,198,198,198,124,0,0,0,0,
198,198,0,198,198,198,198,198,198,198,198,124,0,0,0,0,
0,0,16,16,124,214,208,208,214,124,16,16,0,0,0,0,
0,0,56,108,96,240,96,96,96,96,242,220,0,0,0,0,
0,0,102,102,102,60,24,126,24,126,24,24,0,0,0,0,
0,0,248,204,204,248,196,204,222,204,204,198,0,0,0,0,
0,0,14,27,24,24,126,24,24,24,24,24,24,216,112,0,
0,6,12,16,0,120,12,124,204,204,204,118,0,0,0,0,
0,6,12,16,0,56,24,24,24,24,24,60,0,0,0,0,
0,6,12,16,0,124,198,198,198,198,198,124,0,0,0,0,
0,6,12,16,0,204,204,204,204,204,204,118,0,0,0,0,
0,0,118,220,0,220,102,102,102,102,102,102,0,0,0,0,
118,220,0,134,198,230,246,254,222,206,198,198,0,0,0,0,
0,56,12,60,108,54,0,126,0,0,0,0,0,0,0,0,
0,0,60,102,102,60,0,126,0,0,0,0,0,0,0,0,
0,0,48,48,0,48,48,96,192,198,198,124,0,0,0,0,
0,0,0,0,0,0,254,192,192,192,192,0,0,0,0,0,
0,0,0,0,0,0,254,6,6,6,6,0,0,0,0,0,
0,96,224,100,108,120,48,96,220,182,12,24,62,0,0,0,
0,96,224,100,108,120,48,108,220,172,62,12,12,0,0,0,
0,0,24,24,0,24,24,24,60,60,60,24,0,0,0,0,
0,0,0,0,0,54,108,216,108,54,0,0,0,0,0,0,
0,0,0,0,0,216,108,54,108,216,0,0,0,0,0,0,
17,68,17,68,17,68,17,68,17,68,17,68,17,68,17,68,
85,170,85,170,85,170,85,170,85,170,85,170,85,170,85,170,
221,119,221,119,221,119,221,119,221,119,221,119,221,119,221,119,
24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,
24,24,24,24,24,24,24,248,24,24,24,24,24,24,24,24,
24,24,24,24,24,248,24,248,24,24,24,24,24,24,24,24,
54,54,54,54,54,54,54,246,54,54,54,54,54,54,54,54,
0,0,0,0,0,0,0,254,54,54,54,54,54,54,54,54,
0,0,0,0,0,248,24,248,24,24,24,24,24,24,24,24,
54,54,54,54,54,246,6,246,54,54,54,54,54,54,54,54,
54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,
0,0,0,0,0,254,6,246,54,54,54,54,54,54,54,54,
54,54,54,54,54,246,6,254,0,0,0,0,0,0,0,0,
54,54,54,54,54,54,54,254,0,0,0,0,0,0,0,0,
24,24,24,24,24,248,24,248,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,248,24,24,24,24,24,24,24,24,
24,24,24,24,24,24,24,31,0,0,0,0,0,0,0,0,
24,24,24,24,24,24,24,255,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,255,24,24,24,24,24,24,24,24,
24,24,24,24,24,24,24,31,24,24,24,24,24,24,24,24,
0,0,0,0,0,0,0,255,0,0,0,0,0,0,0,0,
24,24,24,24,24,24,24,255,24,24,24,24,24,24,24,24,
24,24,24,24,24,31,24,31,24,24,24,24,24,24,24,24,
54,54,54,54,54,54,54,55,54,54,54,54,54,54,54,54,
54,54,54,54,54,55,48,63,0,0,0,0,0,0,0,0,
0,0,0,0,0,63,48,55,54,54,54,54,54,54,54,54,
54,54,54,54,54,247,0,255,0,0,0,0,0,0,0,0,
0,0,0,0,0,255,0,247,54,54,54,54,54,54,54,54,
54,54,54,54,54,55,48,55,54,54,54,54,54,54,54,54,
0,0,0,0,0,255,0,255,0,0,0,0,0,0,0,0,
54,54,54,54,54,247,0,247,54,54,54,54,54,54,54,54,
24,24,24,24,24,255,0,255,0,0,0,0,0,0,0,0,
54,54,54,54,54,54,54,255,0,0,0,0,0,0,0,0,
0,0,0,0,0,255,0,255,24,24,24,24,24,24,24,24,
0,0,0,0,0,0,0,255,54,54,54,54,54,54,54,54,
54,54,54,54,54,54,54,63,0,0,0,0,0,0,0,0,
24,24,24,24,24,31,24,31,0,0,0,0,0,0,0,0,
0,0,0,0,0,31,24,31,24,24,24,24,24,24,24,24,
0,0,0,0,0,0,0,63,54,54,54,54,54,54,54,54,
54,54,54,54,54,54,54,255,54,54,54,54,54,54,54,54,
24,24,24,24,24,255,24,255,24,24,24,24,24,24,24,24,
24,24,24,24,24,24,24,248,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,31,24,24,24,24,24,24,24,24,
255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
0,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,
240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,240,
15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,
255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,116,220,200,200,200,220,118,0,0,0,0,
0,0,120,204,204,216,204,198,198,198,220,192,64,0,0,0,
0,0,254,98,96,96,96,96,96,96,96,240,0,0,0,0,
0,0,0,0,2,126,236,108,108,108,108,72,0,0,0,0,
0,0,254,194,96,48,24,48,96,192,194,254,0,0,0,0,
0,0,0,0,0,126,208,200,200,200,200,112,0,0,0,0,
0,0,0,0,0,204,204,204,204,204,204,248,128,128,0,0,
0,0,0,0,0,126,216,24,24,24,24,16,0,0,0,0,
0,0,56,16,124,214,214,214,214,124,16,56,0,0,0,0,
0,0,0,124,198,198,198,254,198,198,198,124,0,0,0,0,
0,0,124,198,198,198,198,198,108,40,40,238,0,0,0,0,
0,0,60,98,48,24,124,204,204,204,204,120,0,0,0,0,
0,0,0,0,0,110,219,219,219,118,0,0,0,0,0,0,
0,0,0,2,6,124,206,222,214,246,230,124,192,128,0,0,
0,0,0,0,0,60,96,192,248,192,96,60,0,0,0,0,
0,0,0,124,198,198,198,198,198,198,198,198,0,0,0,0,
0,0,0,0,254,0,0,254,0,0,254,0,0,0,0,0,
0,0,0,0,24,24,126,24,24,0,0,255,0,0,0,0,
0,0,0,48,24,12,6,12,24,48,0,126,0,0,0,0,
0,0,0,12,24,48,96,48,24,12,0,126,0,0,0,0,
0,0,14,27,27,24,24,24,24,24,24,24,24,24,24,24,
24,24,24,24,24,24,24,24,216,216,216,112,0,0,0,0,
0,0,0,0,24,24,0,126,0,24,24,0,0,0,0,0,
0,0,0,0,0,118,220,0,118,220,0,0,0,0,0,0,
0,56,108,108,56,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,48,48,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,48,0,0,0,0,0,0,0,
0,15,12,12,12,12,12,236,108,108,60,28,0,0,0,0,
0,216,108,108,108,108,108,0,0,0,0,0,0,0,0,0,
0,112,152,24,48,96,248,0,0,0,0,0,0,0,0,0,
0,0,0,0,124,124,124,124,124,124,124,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);
VietFont:DosFontType
=(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,126,129,165,129,129,189,153,129,129,126,0,0,0,0,
0,0,126,255,219,255,255,195,231,255,255,126,0,0,0,0,
0,0,0,0,108,238,254,254,254,124,56,16,0,0,0,0,
0,0,0,0,16,56,124,254,254,124,56,16,0,0,0,0,
0,0,0,24,60,60,90,255,255,90,24,60,0,0,0,0,
0,0,0,16,56,124,254,254,238,84,16,56,0,0,0,0,
0,0,0,0,0,0,24,60,60,24,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,60,102,66,66,102,60,0,0,0,0,0,
255,255,255,255,255,195,153,189,189,153,195,255,255,255,255,255,
0,0,30,14,26,50,120,204,204,204,204,120,0,0,0,0,
0,0,60,102,102,102,102,60,24,126,24,24,0,0,0,0,
0,8,12,10,10,10,8,8,8,120,248,112,0,0,0,0,
0,16,24,20,18,26,22,18,114,242,98,14,30,28,0,0,
0,0,0,16,146,124,108,198,108,124,146,16,0,0,0,0,
0,0,128,192,224,248,254,248,224,192,128,0,0,0,0,0,
0,0,2,6,14,62,254,62,14,6,2,0,0,0,0,0,
0,0,16,56,124,214,16,16,214,124,56,16,0,0,0,0,
0,0,102,102,102,102,102,102,102,0,102,102,0,0,0,0,
0,0,127,219,219,219,219,123,27,27,27,27,0,0,0,0,
0,124,198,96,56,108,198,198,108,56,12,198,124,0,0,0,
0,0,0,0,0,0,0,0,254,254,254,254,0,0,0,0,
0,0,16,56,124,214,16,16,214,124,56,16,254,0,0,0,
0,0,16,56,124,214,16,16,16,16,16,16,0,0,0,0,
0,0,16,16,16,16,16,16,214,124,56,16,0,0,0,0,
0,0,0,0,16,24,12,254,12,24,16,0,0,0,0,0,
0,0,0,0,16,48,96,254,96,48,16,0,0,0,0,0,
0,0,0,0,0,0,192,192,192,254,0,0,0,0,0,0,
0,0,0,0,0,36,66,255,66,36,0,0,0,0,0,0,
0,0,0,0,16,56,56,124,124,254,254,0,0,0,0,0,
0,0,0,0,254,254,124,124,56,56,16,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,24,60,60,60,24,24,24,0,24,24,0,0,0,0,
0,102,102,34,34,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,108,108,254,108,108,254,108,108,0,0,0,0,0,
0,16,16,124,214,214,112,56,28,214,214,124,16,16,0,0,
0,0,96,146,150,108,24,48,108,210,146,12,0,0,0,0,
0,0,56,108,108,56,48,118,220,204,204,118,0,0,0,0,
0,24,24,8,16,0,0,0,0,0,0,0,0,0,0,0,
0,0,12,24,48,48,48,48,48,48,24,12,0,0,0,0,
0,0,48,24,12,12,12,12,12,12,24,48,0,0,0,0,
0,0,0,0,0,102,60,255,60,102,0,0,0,0,0,0,
0,0,0,0,0,24,24,126,24,24,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,48,48,16,32,0,0,
0,0,0,0,0,0,0,254,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,48,48,0,0,0,0,
0,0,0,2,6,12,24,48,96,192,128,0,0,0,0,0,
0,0,124,198,198,206,222,246,230,198,198,124,0,0,0,0,
0,0,24,56,120,24,24,24,24,24,24,126,0,0,0,0,
0,0,124,198,6,12,24,48,96,192,198,254,0,0,0,0,
0,0,124,198,6,6,60,6,6,6,198,124,0,0,0,0,
0,0,12,28,60,108,204,204,254,12,12,30,0,0,0,0,
0,0,254,192,192,192,252,6,6,6,198,124,0,0,0,0,
0,0,124,198,192,192,252,198,198,198,198,124,0,0,0,0,
0,0,254,198,6,6,12,24,48,48,48,48,0,0,0,0,
0,0,124,198,198,198,124,198,198,198,198,124,0,0,0,0,
0,0,124,198,198,198,198,126,6,6,198,124,0,0,0,0,
0,0,0,0,24,24,0,0,0,24,24,0,0,0,0,0,
0,0,0,0,24,24,0,0,0,24,24,8,16,0,0,0,
0,0,0,6,12,24,48,96,48,24,12,6,0,0,0,0,
0,0,0,0,0,126,0,0,126,0,0,0,0,0,0,0,
0,0,0,96,48,24,12,6,12,24,48,96,0,0,0,0,
0,0,124,198,198,6,12,24,24,0,24,24,0,0,0,0,
0,0,0,60,66,157,165,165,173,182,64,60,0,0,0,0,
0,0,56,108,198,198,198,254,198,198,198,198,0,0,0,0,
0,0,252,102,102,102,124,102,102,102,102,252,0,0,0,0,
0,0,124,198,198,192,192,192,192,198,198,124,0,0,0,0,
0,0,252,102,102,102,102,102,102,102,102,252,0,0,0,0,
0,0,254,102,98,104,120,120,104,98,102,254,0,0,0,0,
0,0,254,102,98,104,120,120,104,96,96,240,0,0,0,0,
0,0,124,198,198,192,192,206,198,198,198,126,0,0,0,0,
0,0,198,198,198,198,254,198,198,198,198,198,0,0,0,0,
0,0,60,24,24,24,24,24,24,24,24,60,0,0,0,0,
0,0,30,12,12,12,12,12,204,204,204,120,0,0,0,0,
0,0,230,102,102,108,120,120,108,102,102,230,0,0,0,0,
0,0,240,96,96,96,96,96,96,98,102,254,0,0,0,0,
0,0,130,198,238,254,254,214,198,198,198,198,0,0,0,0,
0,0,134,198,230,246,254,222,206,198,198,198,0,0,0,0,
0,0,124,198,198,198,198,198,198,198,198,124,0,0,0,0,
0,0,252,102,102,102,102,124,96,96,96,240,0,0,0,0,
0,0,124,198,198,198,198,198,198,214,222,124,6,0,0,0,
0,0,252,102,102,102,102,124,108,102,102,230,0,0,0,0,
0,0,124,198,198,96,56,12,6,198,198,124,0,0,0,0,
0,0,126,126,90,24,24,24,24,24,24,60,0,0,0,0,
0,0,198,198,198,198,198,198,198,198,198,124,0,0,0,0,
0,0,198,198,198,198,198,198,198,108,56,16,0,0,0,0,
0,0,198,198,198,198,198,214,254,238,198,130,0,0,0,0,
0,0,198,198,108,124,56,56,124,108,198,198,0,0,0,0,
0,0,102,102,102,102,60,24,24,24,24,60,0,0,0,0,
0,0,254,198,134,12,24,48,96,194,198,254,0,0,0,0,
0,0,60,48,48,48,48,48,48,48,48,60,0,0,0,0,
0,0,0,128,192,96,48,24,12,6,2,0,0,0,0,0,
0,0,60,12,12,12,12,12,12,12,12,60,0,0,0,0,
16,56,108,198,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,255,0,0,
0,24,24,16,8,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,120,12,124,204,204,204,118,0,0,0,0,
0,0,224,96,96,124,102,102,102,102,102,124,0,0,0,0,
0,0,0,0,0,124,198,192,192,192,198,124,0,0,0,0,
0,0,28,12,12,124,204,204,204,204,204,118,0,0,0,0,
0,0,0,0,0,124,198,198,254,192,198,124,0,0,0,0,
0,0,28,54,48,120,48,48,48,48,48,120,0,0,0,0,
0,0,0,0,0,118,204,204,204,204,204,124,12,204,120,0,
0,0,224,96,96,108,118,102,102,102,102,230,0,0,0,0,
0,0,24,24,0,56,24,24,24,24,24,60,0,0,0,0,
0,0,12,12,0,28,12,12,12,12,12,12,204,204,120,0,
0,0,224,96,96,102,108,120,120,108,102,230,0,0,0,0,
0,0,56,24,24,24,24,24,24,24,24,60,0,0,0,0,
0,0,0,0,0,236,254,214,214,214,214,198,0,0,0,0,
0,0,0,0,0,220,102,102,102,102,102,102,0,0,0,0,
0,0,0,0,0,124,198,198,198,198,198,124,0,0,0,0,
0,0,0,0,0,220,102,102,102,102,102,124,96,96,240,0,
0,0,0,0,0,124,204,204,204,204,204,124,12,12,30,0,
0,0,0,0,0,222,118,96,96,96,96,240,0,0,0,0,
0,0,0,0,0,124,198,96,56,12,198,124,0,0,0,0,
0,0,16,48,48,252,48,48,48,48,52,24,0,0,0,0,
0,0,0,0,0,204,204,204,204,204,204,118,0,0,0,0,
0,0,0,0,0,198,198,198,198,108,56,16,0,0,0,0,
0,0,0,0,0,198,214,214,214,214,254,108,0,0,0,0,
0,0,0,0,0,198,198,108,56,108,198,198,0,0,0,0,
0,0,0,0,0,198,198,198,198,198,198,126,6,12,248,0,
0,0,0,0,0,254,140,24,48,96,194,254,0,0,0,0,
0,0,14,24,24,24,112,24,24,24,24,14,0,0,0,0,
0,0,24,24,24,24,0,0,24,24,24,24,0,0,0,0,
0,0,112,24,24,24,14,24,24,24,24,112,0,0,0,0,
0,0,118,220,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,16,56,108,198,198,198,254,0,0,0,0,0,
0, 0,108, 56, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
12, 24,108, 56, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
96, 48,108, 56, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
48, 16,108, 56, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
20, 40,108, 56, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
0, 0,108, 56, 0,120, 12,124,204,204,204,118, 0, 48, 48, 0,
0, 0, 56,108, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
6, 12, 56,108, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
192, 96, 56,108, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
28, 4, 56,108, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
54,108, 56,108, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
0, 0, 56,108, 0,120, 12,124,204,204,204,118, 0, 48, 48, 0,
0, 0, 56,108, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
6, 12, 56,108, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
192, 96, 56,108, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
28, 4, 56,108, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
54,108, 56,108, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
0, 0, 56,108, 0,124,198,254,192,192,198,124, 0, 48, 48, 0,
0, 0, 0, 6, 2,126,198,198,198,198,198,124, 0, 0, 0, 0,
0, 12, 24, 6, 2,126,198,198,198,198,198,124, 0, 0, 0, 0,
0, 96, 48, 6, 2,126,198,198,198,198,198,124, 0, 0, 0, 0,
0, 56, 8, 22, 2,126,198,198,198,198,198,124, 0, 0, 0, 0,
0, 54,108, 6, 2,126,198,198,198,198,198,124, 0, 0, 0, 0,
0, 0, 0, 6, 2,126,198,198,198,198,198,124, 0, 48, 48, 0,
0, 0, 56,108, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
6, 12, 56,108, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
192, 96, 56,108, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
14, 2, 60,108, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
54,108, 56,108, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
0, 0, 56,108, 0,124,198,198,198,198,198,124, 0, 48, 48, 0,
0, 0, 0, 6, 2,206,204,204,204,204,204,118, 0, 0, 0, 0,
0, 12, 24, 6, 2,206,204,204,204,204,204,118, 0, 0, 0, 0,
0, 96, 48, 6, 2,206,204,204,204,204,204,118, 0, 0, 0, 0,
0, 56, 8, 22, 2,206,204,204,204,204,204,118, 0, 0, 0, 0,
0, 54,108, 6, 2,206,204,204,204,204,204,118, 0, 0, 0, 0,
0, 0, 0, 6, 2,206,204,204,204,204,204,118, 0, 48, 48, 0,
0, 0, 12, 24, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
0, 0, 96, 48, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
0, 56, 8, 16, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
0, 0, 54,108, 0,120, 12,124,204,204,204,118, 0, 0, 0, 0,
0, 0, 0, 0, 0,120, 12,124,204,204,204,118, 0, 48, 48, 0,
0, 0, 12, 24, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
0, 0, 96, 48, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
0, 56, 8, 16, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
0, 0, 54,108, 0,124,198,254,192,192,198,124, 0, 0, 0, 0,
0, 0, 0, 0, 0,124,198,254,192,192,198,124, 0, 48, 48, 0,
0, 0, 12, 24, 0, 56, 24, 24, 24, 24, 24, 60, 0, 0, 0, 0,
0, 0, 48, 24, 0, 56, 24, 24, 24, 24, 24, 60, 0, 0, 0, 0,
17, 68, 17, 68, 17, 68, 17, 68, 17, 68, 17, 68, 17, 68, 17, 68,
85,170, 85,170, 85,170, 85,170, 85,170, 85,170, 85,170, 85,170,
221,119,221,119,221,119,221,119,221,119,221,119,221,119,221,119,
24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
24, 24, 24, 24, 24, 24, 24,248, 24, 24, 24, 24, 24, 24, 24, 24,
0, 56, 8, 16, 0, 56, 24, 24, 24, 24, 24, 60, 0, 0, 0, 0,
0, 0, 54,108, 0, 56, 24, 24, 24, 24, 24, 60, 0, 0, 0, 0,
0, 0, 24, 24, 0, 56, 24, 24, 24, 24, 24, 60, 0, 24, 24, 0,
0, 0, 12, 24, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
54, 54, 54, 54, 54,246, 6,246, 54, 54, 54, 54, 54, 54, 54, 54,
54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54,
0, 0, 0, 0, 0,254, 6,246, 54, 54, 54, 54, 54, 54, 54, 54,
54, 54, 54, 54, 54,246, 6,254, 0, 0, 0, 0, 0, 0, 0, 0,
54, 54, 54, 54, 54, 54, 54,254, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 96, 48, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0,248, 24, 24, 24, 24, 24, 24, 24, 24,
24, 24, 24, 24, 24, 24, 24, 31, 0, 0, 0, 0, 0, 0, 0, 0,
24, 24, 24, 24, 24, 24, 24,255, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0,255, 24, 24, 24, 24, 24, 24, 24, 24,
24, 24, 24, 24, 24, 24, 24, 31, 24, 24, 24, 24, 24, 24, 24, 24,
0, 0, 0, 0, 0, 0, 0,255, 0, 0, 0, 0, 0, 0, 0, 0,
24, 24, 24, 24, 24, 24, 24,255, 24, 24, 24, 24, 24, 24, 24, 24,
0, 56, 8, 16, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
0, 0, 54,108, 0,124,198,198,198,198,198,124, 0, 0, 0, 0,
54, 54, 54, 54, 54, 55, 48, 63, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 63, 48, 55, 54, 54, 54, 54, 54, 54, 54, 54,
54, 54, 54, 54, 54,247, 0,255, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0,255, 0,247, 54, 54, 54, 54, 54, 54, 54, 54,
54, 54, 54, 54, 54, 55, 48, 55, 54, 54, 54, 54, 54, 54, 54, 54,
0, 0, 0, 0, 0,255, 0,255, 0, 0, 0, 0, 0, 0, 0, 0,
54, 54, 54, 54, 54,247, 0,247, 54, 54, 54, 54, 54, 54, 54, 54,
24, 24, 24, 24, 24,255, 0,255, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0,124,198,198,198,198,198,124, 0, 48, 48, 0,
0, 0, 0, 0, 0,255, 0,255, 24, 24, 24, 24, 24, 24, 24, 24,
0, 0, 12, 24, 0,204,204,204,204,204,204,118, 0, 0, 0, 0,
0, 0, 96, 48, 0,204,204,204,204,204,204,118, 0, 0, 0, 0,
0, 56, 8, 16, 0,204,204,204,204,204,204,118, 0, 0, 0, 0,
0, 0,108,216, 0,204,204,204,204,204,204,118, 0, 0, 0, 0,
0, 0, 0, 0, 0,204,204,204,204,204,204,118, 0, 48, 48, 0,
0, 0, 12, 24, 0,198,198,198,198,198,198,126, 6, 12,248, 0,
0, 0, 96, 48, 0,198,198,198,198,198,198,126, 6, 12,248, 0,
24, 24, 24, 24, 24, 24, 24,248, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 31, 24, 24, 24, 24, 24, 24, 24, 24,
255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,
0, 0, 0, 0, 0, 0, 0,255,255,255,255,255,255,255,255,255,
0, 0, 56, 8, 16,198,198,198,198,198,198,126, 6, 12,248, 0,
0, 0, 54,108, 0,198,198,198,198,198,198,126, 6, 12,248, 0,
255,255,255,255,255,255,255, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0,118,220,216,216,216,220,118, 0, 0, 0, 0,
0, 0, 0, 0,120,204,216,204,198,198,198,204,192,192, 0, 0,
0, 0, 0,254,198,198,192,192,192,192,192,192, 0, 0, 0, 0,
0, 0, 0, 0,128,254,108,108,108,108,108,108, 0, 0, 0, 0,
0, 0, 0,254,198, 96, 48, 24, 48, 96,198,254, 0, 0, 0, 0,
0, 0, 0, 0, 0,126,216,216,216,216,216,112, 0, 0, 0, 0,
0, 0, 0, 0,102,102,102,102,102,124, 96, 96,192, 0, 0, 0,
0, 0, 0, 0,118,220, 24, 24, 24, 24, 24, 24, 0, 0, 0, 0,
0, 0, 0,126, 24, 60,102,102,102, 60, 24,126, 0, 0, 0, 0,
0, 0, 0, 56,108,198,198,254,198,198,108, 56, 0, 0, 0, 0,
0, 0, 56,108,198,198,198,108,108,108,108,238, 0, 0, 0, 0,
0, 0, 30, 48, 24, 12, 62,102,102,102,102, 60, 0, 0, 0, 0,
0, 0, 0, 0, 0,126,219,219,219,126, 0, 0, 0, 0, 0, 0,
0, 0, 0, 3, 6,126,207,219,243,126, 96,192, 0, 0, 0, 0,
0, 0, 28, 48, 96, 96,124, 96, 96, 96, 48, 28, 0, 0, 0, 0,
0, 0, 0,124,198,198,198,198,198,198,198,198, 0, 0, 0, 0,
0, 0, 0, 0,254, 0, 0,254, 0, 0,254, 0, 0, 0, 0, 0,
0, 0, 0, 0, 24, 24,126, 24, 24, 0, 0,255, 0, 0, 0, 0,
0, 0, 0, 48, 24, 12, 6, 12, 24, 48, 0,126, 0, 0, 0, 0,
0, 0, 0, 12, 24, 48, 96, 48, 24, 12, 0,126, 0, 0, 0, 0,
0, 0, 14, 27, 27, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24,
24, 24, 24, 24, 24, 24, 24, 24,216,216,216,112, 0, 0, 0, 0,
0, 0, 0, 0, 24, 24, 0,126, 0, 24, 24, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0,118,220, 0,118,220, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0,198,198,198,198,198,198,126, 6, 12,248, 24,
0, 0, 12, 30, 12, 60,108,204,204,204,204,118, 0, 0, 0, 0,
0, 0,248,108,102,102,246,102,102,102,108,248, 0, 0, 0, 0,
0, 15, 12, 12, 12, 12, 12,236,108,108, 60, 28, 0, 0, 0, 0,
0,216,108,108,108,108,108, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0,112,152, 48, 96,200,248, 0, 0, 0, 0, 0, 0, 0, 0, 0,
0, 0, 0, 0,124,124,124,124,124,124,124, 0, 0, 0, 0, 0,
0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0);
VietUserKB : UserKB
=('aw','aws','awf','awr','awx','awj',
'aa','aas','aaf','aar','aax','aaj','ee','ees','eef','eer','eex','eej',
'ow','ows','owf','owr','owx','owj','oo','oos','oof','oor','oox',
'ooj','uw','uws','uwf','uwr','uwx','uwj','as','af','ar','ax',
'aj','es','ef','er','ex','ej','is','if','°','±','²','³','´',
'ir','ix','ij','os','¹','º','¿','¼','½','of','ª','À','Á','Â','Ã','Ä','Å',
'or','ox','È','É','Ê','Ë','Ì','Í','Î','Ï','oj','Ñ','us','uf','ur',
'ux','uj','ys','yf','Ù','Ú','Û','Ü','yf','yx','ß','à','á','â','ã',
'ä','å','æ','ç','è','é','ê','ë','ì','í','î','ï','ð','ñ','ò','ó',
'ô','õ','ö','÷','yj','dd','Dd','û','ü','ý','yr',#255);
Procedure InitVietFont;
Procedure CloseVietFont;
procedure Outtext(x, y : integer; s : string; color : byte; bck : integer);
function LowerCase ( c : char ) : char;
function Vtrans(s:string):string;
function Vtyping(c : char ) : str3;
Function SpecTrans(s : string) : string;
Procedure VtypingTrans(var s: string);
implementation
var i : integer;
    DefUserKB : UserKB;
    InputMethod : byte;
Procedure InitVietFont;
begin
 asm
  mov ax, seg VietFont
  mov es, ax
  mov bp, offset VietFont
  mov ax, 1110h
  mov bx, 1000h
  mov cx, 256
  mov dx, 0
  int 10h
 end;
DefUserKB := vietUserKB;
end;
Procedure CloseVietFont;
begin
asm
  mov ax, seg DosFont
  mov es, ax
  mov bp, offset DosFont
  mov ax, 1110h
  mov bx, 1000h
  mov cx, 256
  mov dx, 0
  int 10h
end;
end;
function SendCode(s:string):shortint;
var i:integer;
begin
i:=128;
While (i<=255) and (s<>DefUserKb[i-128]) do
inc(i);
if i>255 then i:=-1 else i := i - 128;
sendcode:=i;
end;
function Vtyping(c : char ) : str3;
var i : integer;
begin
i := 128 ;
while (i <= 255) and ( c <> chr(i)) do inc(i);
if i >255 then Vtyping := c else
Vtyping := DefUserKB[i-128];
end;
Procedure VtypingTrans(var s: string);
var i : integer;st : str3;
begin
i := 0;
while i <= length(s) do
      begin
      inc(i);
      st := Vtyping(s[i]);
      if st <> s[i] then begin delete(s,i,1);
      insert(st,s,i);inc(i,length(st)-1);end;
      end;
end;
function LowerCase ( c : char ) : char;
begin
lowerCase := chr(ord(c) + 32);
end;
function TelexTrans(s:string):string;
var i,r:integer;st:string;
        codeback:integer;
        k:string;
begin
st:='';
if s='' then begin TelexTrans:='';exit;end;
i:=1;
k:=s;
While k[1]=' ' do delete(k,1,1);
While k[length(k)]=' ' do delete(k,length(k),1);
if (k[1]='|') and (k[length(k)]='|') then
begin
k:=s;
delete(k,pos('|',k),1);
delete(k,pos('|',k),1);
s:=k;
TelexTrans:=s;
exit;
end;
While i<=length(s) do
        begin
        codeback:=-1;
        if (s[i] in ['a','e','o','u','i','y','d','D']) and (i+1<=length(s)) then
                begin
                r:=i;
                case s[r] of
                'a': if s[r+1] in ['s','f','r','x','j'] then
                     begin codeback:=sendcode(s[r]+s[r+1]);
                           delete(s,r,2);
                           end
                     else if s[r+1] in ['a','w'] then
                        begin
                        if s[r+2] in ['s','f','r','x','j']
                                then begin codeback:=sendcode(s[r]+s[r+1]+s[r+2]);
                                           delete(s,r,3);
                                     end
                                else
                                begin
                                codeback:=sendcode(s[r]+s[r+1]);
                                delete(s,r,2);
                                end;
                        end;
                 'e': if s[i+1] in ['s','f','r','x','j'] then
                     begin codeback:=sendcode(s[r]+s[r+1]);
                           delete(s,r,2);
                           end
                     else if s[i+1] in ['e'] then
                        begin
                        if s[i+2] in ['s','f','r','x','j']
                                then begin codeback:=sendcode(s[r]+s[r+1]+s[r+2]);
                                           delete(s,r,3);
                                     end
                                else
                                begin
                                codeback:=sendcode(s[r]+s[r+1]);
                                delete(s,r,2);
                                end;
                        end;
                  'o': if s[r+1] in ['s','f','r','x','j'] then
                     begin codeback:=sendcode(s[r]+s[r+1]);
                           delete(s,r,2);
                           end
                     else if s[r+1] in ['o','w'] then
                        begin
                        if s[r+2] in ['s','f','r','x','j']
                                then begin codeback:=sendcode(s[r]+s[r+1]+s[r+2]);
                                           delete(s,r,3);
                                     end
                               else
                                begin
                                codeback:=sendcode(s[r]+s[r+1]);
                                delete(s,r,2);
                                end;
                        end;
                   'u': if s[r+1] in ['s','f','r','x','j'] then
                     begin codeback:=sendcode(s[r]+s[r+1]);
                           delete(s,r,2);
                           end
                     else if s[r+1] in ['w'] then
                        begin
                        if s[r+2] in ['s','f','r','x','j']
                                then begin codeback:=sendcode(s[r]+s[r+1]+s[r+2]);
                                           delete(s,r,3);
                                           end
                                else
                                begin
                                codeback:=sendcode(s[r]+s[r+1]);
                                delete(s,r,2);
                                end;
                        end;
                   'i': if s[r+1] in ['s','f','r','x','j'] then
                     begin codeback:=sendcode(s[r]+s[r+1]);
                           delete(s,r,2);
                           end;
                   'd','D': if s[r+1] in ['d'] then
                     begin codeback:=sendcode(s[r]+s[r+1]);
                           delete(s,r,2);
                           end;
                   'y': if s[r+1] in ['s','f','r','x','j'] then
                        begin codeback:=sendcode(s[r]+s[r+1]);
                           delete(s,r,2);
                           end;
                     end;
                 end;
        if codeback<>-1 then St:=st+chr(codeback+128)
        else
        begin
        st:=st+s[i];
        inc(i,1);
        end;
end;
TelexTrans:=st;
end;
Function TestAll(c:char;s:string):boolean;
var i:integer;
begin
TestAll:=false;
for i:=1 to length(s) do if s[i]<> c then exit;
TestAll:=true;
end;
procedure Outchar(x, y : integer; c : char; color : byte; bck : integer);
var j, k, n : integer;
begin
n := ord(c) * 16;
for j := 0 to 15 do
    for k := 7 downto 0 do
        if ((Vietfont[n + j] shr k) and 1) = 1 then putpixel(x + 8 - k - 1, y + j, color)
        else if bck <> - 1 then putpixel(x + 8 - k - 1, y + j, bck)
end;
procedure Outtext(x, y : integer; s : string; color : byte; bck : integer);
var i : integer;
begin
for i := 1 to length(s) do
    Outchar(x + (i - 1) * 8, y, s[i], color, bck);
end;
function Vtrans(s:string):string;
var i:integer;st,ex,k:string;
        resultstr:string;
begin
st:=s;
if s='' then begin vtrans:='';exit;end;
st:=st+' ';
ex:='';k:='';resultstr:='';
case inputMethod of
1:
while st<>'' do
begin
if (st='') or (TestAll(' ',st)) then begin delete(st,length(st),1);vtrans:=resultstr+st;exit;end;
k:=copy(st,1,pos(' ',st));
if k=' ' then ex:=' ' else
ex:=TelexTrans(k);
resultstr:=resultstr+ex;
delete(st,1,pos(' ',st));
end;
end;
delete(resultstr,length(resultstr),1);
vtrans:=resultstr;
end;
Function SpecTrans(s : string) : string;
var i : integer;news : string;
begin
if length(s) > 2 then
if (s[length(s)] in TelexEvKey)
   and (s[length(s) - 1] = s[length(s)]) then
       begin
       news := copy(s,1,length(s)-2);
       news := vtrans(news);
       news := news + s[length(s)];
       SpecTrans := news;
       exit;
       end;
SpecTrans := Vtrans(s);
end;
begin
inputmethod := 1;
end.